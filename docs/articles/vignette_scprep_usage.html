<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>scprep: Single-cell Data Object Types Guide • scprep</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="scprep: Single-cell Data Object Types Guide">
<meta property="og:description" content="scprep">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scprep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_scprep_usage.html">scprep: Single-cell Data Object Types Guide</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>scprep: Single-cell Data Object Types Guide</h1>
                        <h4 data-toc-skip class="author">scprep
package</h4>
            
            <h4 data-toc-skip class="date">2025-09-05</h4>
      
      
      <div class="hidden name"><code>vignette_scprep_usage.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>scprep</code> package provides a unified interface for
reading and processing single-cell RNA-seq data from 10X Genomics Cell
Ranger output. The package supports conversion to three popular
single-cell data object types:</p>
<ul>
<li>
<strong>ExpressionSet</strong> (Biobase) - Default output
format</li>
<li>
<strong>Seurat</strong> - Popular for single-cell analysis
workflows<br>
</li>
<li>
<strong>SingleCellExperiment</strong> - Bioconductor standard for
single-cell data</li>
</ul>
<p>This vignette demonstrates how to read 10X data and convert it to
each object type, then explore the structure of each object to
understand where counts data, cell metadata, and gene metadata are
stored.</p>
<hr>
</div>
<div class="section level2">
<h2 id="example-data-setup">Example Data Setup<a class="anchor" aria-label="anchor" href="#example-data-setup"></a>
</h2>
<hr>
<p>For this example, we’ll use simulated sample paths and annotation
data that match the expected format for <code>scprep</code>. In
practice, these would point to your actual 10X Cell Ranger output
directories.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># First let's load the required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scprep</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biobase" class="external-link">Biobase</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org" class="external-link">Matrix</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For this vignette, we will load data from 2 example samples from the 'scdata' package and store in a list (also accepted by 'scprep') (normally you would load data from directories where the 10X data is stored)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scdata</span><span class="op">)</span></span>
<span><span class="co"># Load the PBMC 3p and 5p example sample data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PBMC_3p_10K</span>, package<span class="op">=</span><span class="st">"scdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PBMC_5p_10K</span>, package<span class="op">=</span><span class="st">"scdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Store in example_data list - we will only use a subset of the data to keep it lightweight</span></span>
<span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  Sample_1 <span class="op">=</span> <span class="va">PBMC_3p_10K</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span>,</span>
<span>  Sample_2 <span class="op">=</span> <span class="va">PBMC_5p_10K</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean up the original loaded objects to free memory</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">PBMC_3p_10K</span>, <span class="va">PBMC_5p_10K</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># Force garbage collection</span></span>
<span><span class="co">#&gt;            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)</span></span>
<span><span class="co">#&gt; Ncells  7173896 383.2   12391758  661.8         NA   8679818  463.6</span></span>
<span><span class="co">#&gt; Vcells 19181055 146.4  146549777 1118.1      16384 158809916 1211.7</span></span>
<span></span>
<span><span class="co"># We will create some fake sample paths for the purpose of this example, which will purely be stored in metadata (again, normally you would replace with your actual 10x data directories)</span></span>
<span><span class="va">sample_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"/path/to/Sample_1"</span>,</span>
<span>  <span class="st">"/path/to/Sample_2"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example annotation data (modify based on your experimental design)</span></span>
<span><span class="va">annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Sample_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sample_1"</span>, <span class="st">"Sample_2"</span><span class="op">)</span>,</span>
<span>  Index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SI-GA-A1"</span>, <span class="st">"SI-GA-B1"</span><span class="op">)</span>, </span>
<span>  Sample_Project <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scRNA_10X_Project"</span>, <span class="st">"scRNA_10X_Project"</span><span class="op">)</span>,</span>
<span>  Reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"refdata-cellranger-GRCh38-3.0.0"</span>, <span class="st">"refdata-cellranger-GRCh38-3.0.0"</span><span class="op">)</span>,</span>
<span>  Tissue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Blood"</span>, <span class="st">"Blood"</span><span class="op">)</span>,</span>
<span>  Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PBMC"</span>, <span class="st">"PBMC"</span><span class="op">)</span>,</span>
<span>  Donor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Sample annotation:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Sample annotation:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sample_ID    Index    Sample_Project                       Reference Tissue</span></span>
<span><span class="co">#&gt; 1  Sample_1 SI-GA-A1 scRNA_10X_Project refdata-cellranger-GRCh38-3.0.0  Blood</span></span>
<span><span class="co">#&gt; 2  Sample_2 SI-GA-B1 scRNA_10X_Project refdata-cellranger-GRCh38-3.0.0  Blood</span></span>
<span><span class="co">#&gt;   Type Donor</span></span>
<span><span class="co">#&gt; 1 PBMC     1</span></span>
<span><span class="co">#&gt; 2 PBMC     2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reading-data-and-object-conversion">Reading Data and Object Conversion<a class="anchor" aria-label="anchor" href="#reading-data-and-object-conversion"></a>
</h2>
<p>The <code>scprep</code> package provides two main approaches for
reading and processing 10X data:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Direct function calls</strong> using
<code><a href="../reference/scprep_build.html">scprep_build()</a></code>
</li>
<li>
<strong>Template workflow</strong> using
<code><a href="../reference/template_scprep.html">template_scprep()</a></code> with parameter files</li>
</ol>
<div class="section level3">
<h3 id="direct-function-approach">Direct Function Approach<a class="anchor" aria-label="anchor" href="#direct-function-approach"></a>
</h3>
<p>The <code><a href="../reference/scprep_build.html">scprep_build()</a></code> function is the core entry point for
reading 10X data and can output different object types using the
<code>output_type</code> parameter.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="expressionset">ExpressionSet<a class="anchor" aria-label="anchor" href="#expressionset"></a>
</h2>
<hr>
<div class="section level3">
<h3 id="build-expressionset">Build ExpressionSet:<a class="anchor" aria-label="anchor" href="#build-expressionset"></a>
</h3>
<p>Run the ‘scprep_build’ function to read the data and create an
ExpressionSet object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read data and create ExpressionSet object (default)</span></span>
<span><span class="va">eset</span> <span class="op">&lt;-</span> <span class="fu">scprep</span><span class="fu">::</span><span class="fu"><a href="../reference/scprep_build.html">scprep_build</a></span><span class="op">(</span></span>
<span>  sample_paths <span class="op">=</span> <span class="va">sample_paths</span>,</span>
<span>  input_data <span class="op">=</span> <span class="va">example_data</span>, <span class="co"># normally, you would set this to FALSE to read directly from sample_paths</span></span>
<span>  annotation <span class="op">=</span> <span class="va">annotation</span>,</span>
<span>  file_type <span class="op">=</span> <span class="st">"h5"</span>,</span>
<span>  vdj <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cite <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  atac <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"ExpressionSet"</span>,  <span class="co"># This is the default</span></span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Building ExpressionSet object </span></span>
<span><span class="co">#&gt; Using pre-loaded count matrices from input_data </span></span>
<span><span class="co">#&gt; Loaded matrix for Sample_1 : 1000 cells </span></span>
<span><span class="co">#&gt; Loaded matrix for Sample_2 : 1000 cells </span></span>
<span><span class="co">#&gt; Using provided annotation matching input_data names </span></span>
<span><span class="co">#&gt; Total cells loaded: 2000 </span></span>
<span><span class="co">#&gt; Calculate UMIs per cell </span></span>
<span><span class="co">#&gt; Calculate Genes per cell </span></span>
<span><span class="co">#&gt; Creating ExpressionSet object directly </span></span>
<span><span class="co">#&gt; ExpressionSet object created with 2000 cells and 36601 genes</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">eset</span><span class="op">)</span></span>
<span><span class="co">#&gt; ExpressionSet (storageMode: environment)</span></span>
<span><span class="co">#&gt; assayData: 36601 features, 2000 samples </span></span>
<span><span class="co">#&gt;   element names: exprs </span></span>
<span><span class="co">#&gt; protocolData: none</span></span>
<span><span class="co">#&gt; phenoData</span></span>
<span><span class="co">#&gt;   sampleNames: AAACCCAGTATATGGA-1-1 AAACCCAGTATCGTAC-1-1 ...</span></span>
<span><span class="co">#&gt;     ACGGCCATCACTGGGC-1-2 (2000 total)</span></span>
<span><span class="co">#&gt;   varLabels: ID Sample ... Genes (10 total)</span></span>
<span><span class="co">#&gt;   varMetadata: labelDescription</span></span>
<span><span class="co">#&gt; featureData: none</span></span>
<span><span class="co">#&gt; experimentData: use 'experimentData(object)'</span></span>
<span><span class="co">#&gt; Annotation:</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="explore-expressionset">Explore ExpressionSet<a class="anchor" aria-label="anchor" href="#explore-expressionset"></a>
</h3>
<p>Now let’s explore the structure of the ExpressionSet object to
understand where different types of data are stored.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic object information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"ExpressionSet dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">eset</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ExpressionSet dimensions: 36601 2000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of samples:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">eset</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Number of samples: 2000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of genes:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">eset</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of genes: 36601</span></span>
<span></span>
<span><span class="co"># Expression data (counts matrix)</span></span>
<span><span class="va">counts_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">eset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Counts matrix class:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Counts matrix class: matrix array</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Counts matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Counts matrix dimensions: 36601 2000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few genes and cells:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "First few genes and cells:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 AAACCCAGTATATGGA-1-1 AAACCCAGTATCGTAC-1-1 AAACCCAGTCGGTGAA-1-1</span></span>
<span><span class="co">#&gt; ENSG00000243485                    0                    0                    0</span></span>
<span><span class="co">#&gt; ENSG00000237613                    0                    0                    0</span></span>
<span><span class="co">#&gt; ENSG00000186092                    0                    0                    0</span></span>
<span><span class="co">#&gt; ENSG00000238009                    0                    0                    0</span></span>
<span><span class="co">#&gt; ENSG00000239945                    0                    0                    0</span></span>
<span></span>
<span><span class="co"># Cell-level metadata (sample information)  </span></span>
<span><span class="va">cell_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">eset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cell metadata dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell metadata dimensions: 2000 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Cell metadata columns:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Cell metadata columns:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "ID"             "Sample"         "Index"          "Sample_Project"</span></span>
<span><span class="co">#&gt;  [5] "Reference"      "Tissue"         "Type"           "Donor"         </span></span>
<span><span class="co">#&gt;  [9] "UMIs"           "Genes"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few rows of cell metadata:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "First few rows of cell metadata:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cell_metadata</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                        ID   Sample    Index    Sample_Project</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1 AAACCCAGTATATGGA-1-1 Sample_1 SI-GA-A1 scRNA_10X_Project</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1 AAACCCAGTATCGTAC-1-1 Sample_1 SI-GA-A1 scRNA_10X_Project</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1 AAACCCAGTCGGTGAA-1-1 Sample_1 SI-GA-A1 scRNA_10X_Project</span></span>
<span><span class="co">#&gt;                                            Reference Tissue Type Donor UMIs</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1 refdata-cellranger-GRCh38-3.0.0  Blood PBMC     1  860</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1 refdata-cellranger-GRCh38-3.0.0  Blood PBMC     1 1548</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1 refdata-cellranger-GRCh38-3.0.0  Blood PBMC     1 6387</span></span>
<span><span class="co">#&gt;                      Genes</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1   350</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1   729</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1  1827</span></span>
<span></span>
<span><span class="co"># Gene-level metadata</span></span>
<span><span class="va">gene_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">eset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gene metadata dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Gene metadata dimensions: 0 0</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Gene metadata columns:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few rows of gene metadata:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene_metadata</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Additional assay data slots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Available assay data slots:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Available assay data slots:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/assayData.html" class="external-link">assayData</a></span><span class="op">(</span><span class="va">eset</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "exprs"</span></span>
<span></span>
<span><span class="co"># Quality control metrics (automatically calculated)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Automatically calculated QC metrics:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Automatically calculated QC metrics:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"UMIs per cell: min ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">eset</span><span class="op">$</span><span class="va">UMIs</span><span class="op">)</span>, <span class="st">"... max ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">eset</span><span class="op">$</span><span class="va">UMIs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "UMIs per cell: min = 500 ... max = 61084"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Genes per cell: min ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">eset</span><span class="op">$</span><span class="va">Genes</span><span class="op">)</span>, <span class="st">"... max ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">eset</span><span class="op">$</span><span class="va">Genes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Genes per cell: min = 75 ... max = 6883"</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)</span></span>
<span><span class="co">#&gt; Ncells  7193578 384.2   12391758  661.8         NA   8679818  463.6</span></span>
<span><span class="co">#&gt; Vcells 92455329 705.4  241076319 1839.3      16384 166293657 1268.8</span></span></code></pre>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="seurat">Seurat<a class="anchor" aria-label="anchor" href="#seurat"></a>
</h2>
<hr>
<div class="section level3">
<h3 id="build-seurat-object">Build Seurat Object:<a class="anchor" aria-label="anchor" href="#build-seurat-object"></a>
</h3>
<p>Run the ‘scprep_build’ function to read the data and create a Seurat
object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read data and create Seurat object</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu">scprep</span><span class="fu">::</span><span class="fu"><a href="../reference/scprep_build.html">scprep_build</a></span><span class="op">(</span></span>
<span>  sample_paths <span class="op">=</span> <span class="va">sample_paths</span>,</span>
<span>  input_data <span class="op">=</span> <span class="va">example_data</span>, <span class="co"># normally, you would set this to FALSE to read directly from sample_paths</span></span>
<span>  annotation <span class="op">=</span> <span class="va">annotation</span>,</span>
<span>  file_type <span class="op">=</span> <span class="st">"h5"</span>, </span>
<span>  vdj <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  atac <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"seurat"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Building seurat object </span></span>
<span><span class="co">#&gt; Using pre-loaded count matrices from input_data </span></span>
<span><span class="co">#&gt; Loaded matrix for Sample_1 : 1000 cells </span></span>
<span><span class="co">#&gt; Loaded matrix for Sample_2 : 1000 cells </span></span>
<span><span class="co">#&gt; Using provided annotation matching input_data names </span></span>
<span><span class="co">#&gt; Total cells loaded: 2000 </span></span>
<span><span class="co">#&gt; Calculate UMIs per cell </span></span>
<span><span class="co">#&gt; Calculate Genes per cell </span></span>
<span><span class="co">#&gt; Creating Seurat object directly </span></span>
<span><span class="co">#&gt; Seurat object created with 2000 cells and 36601 genes</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class Seurat </span></span>
<span><span class="co">#&gt; 36601 features across 2000 samples within 1 assay </span></span>
<span><span class="co">#&gt; Active assay: RNA (36601 features, 0 variable features)</span></span>
<span><span class="co">#&gt;  1 layer present: counts</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="explore-seurat-object">Explore Seurat Object<a class="anchor" aria-label="anchor" href="#explore-seurat-object"></a>
</h3>
<p>Now let’s explore the structure of the Seurat object to understand
where different types of data are stored.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic object information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Seurat object dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Seurat object dimensions: 36601 2000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of cells:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of cells: 2000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of genes:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of genes: 36601</span></span>
<span></span>
<span><span class="co"># Expression data (counts matrix)</span></span>
<span><span class="va">counts_matrix</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/AssayData.html" class="external-link">GetAssayData</a></span><span class="op">(</span><span class="va">seurat_obj</span>, layer <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Counts matrix class:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Counts matrix class: dgCMatrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Counts matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Counts matrix dimensions: 36601 2000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few genes and cells:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "First few genes and cells:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5 x 3 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;                 AAACCCAGTATATGGA-1-1 AAACCCAGTATCGTAC-1-1 AAACCCAGTCGGTGAA-1-1</span></span>
<span><span class="co">#&gt; ENSG00000243485                    .                    .                    .</span></span>
<span><span class="co">#&gt; ENSG00000237613                    .                    .                    .</span></span>
<span><span class="co">#&gt; ENSG00000186092                    .                    .                    .</span></span>
<span><span class="co">#&gt; ENSG00000238009                    .                    .                    .</span></span>
<span><span class="co">#&gt; ENSG00000239945                    .                    .                    .</span></span>
<span></span>
<span><span class="co"># Cell-level metadata</span></span>
<span><span class="va">cell_metadata</span> <span class="op">&lt;-</span> <span class="va">seurat_obj</span><span class="op">@</span><span class="va">meta.data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cell metadata dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell metadata dimensions: 2000 13</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Cell metadata columns:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Cell metadata columns:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "orig.ident"     "nCount_RNA"     "nFeature_RNA"   "ID"            </span></span>
<span><span class="co">#&gt;  [5] "Sample"         "Index"          "Sample_Project" "Reference"     </span></span>
<span><span class="co">#&gt;  [9] "Tissue"         "Type"           "Donor"          "UMIs"          </span></span>
<span><span class="co">#&gt; [13] "Genes"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few rows of cell metadata:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "First few rows of cell metadata:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cell_metadata</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         orig.ident nCount_RNA nFeature_RNA                   ID</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1 SeuratProject        860          350 AAACCCAGTATATGGA-1-1</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1 SeuratProject       1548          729 AAACCCAGTATCGTAC-1-1</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1 SeuratProject       6387         1827 AAACCCAGTCGGTGAA-1-1</span></span>
<span><span class="co">#&gt;                        Sample    Index    Sample_Project</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1 Sample_1 SI-GA-A1 scRNA_10X_Project</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1 Sample_1 SI-GA-A1 scRNA_10X_Project</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1 Sample_1 SI-GA-A1 scRNA_10X_Project</span></span>
<span><span class="co">#&gt;                                            Reference Tissue Type Donor UMIs</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1 refdata-cellranger-GRCh38-3.0.0  Blood PBMC     1  860</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1 refdata-cellranger-GRCh38-3.0.0  Blood PBMC     1 1548</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1 refdata-cellranger-GRCh38-3.0.0  Blood PBMC     1 6387</span></span>
<span><span class="co">#&gt;                      Genes</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1   350</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1   729</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1  1827</span></span>
<span></span>
<span><span class="co"># Gene-level metadata  </span></span>
<span><span class="va">gene_metadata</span> <span class="op">&lt;-</span> <span class="va">seurat_obj</span><span class="op">[[</span><span class="st">"RNA"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gene metadata dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Gene metadata dimensions: 36601 0</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Gene metadata columns:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few rows of gene metadata:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene_metadata</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Available assays</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Available assays:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Available assays:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">@</span><span class="va">assays</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "RNA"</span></span>
<span></span>
<span><span class="co"># Quality control metrics</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="st">"nCount_RNA"</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Seurat QC metrics:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"UMIs per cell: min ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">$</span><span class="va">nCount_RNA</span><span class="op">)</span>, <span class="st">"... max ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">$</span><span class="va">nCount_RNA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "Seurat QC metrics:"</span></span>
<span><span class="co">#&gt; [1] "UMIs per cell: min = 500 ... max = 61084"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="st">"nFeature_RNA"</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Genes per cell: min ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">$</span><span class="va">nFeature_RNA</span><span class="op">)</span>, <span class="st">"... max ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">$</span><span class="va">nFeature_RNA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "Genes per cell: min = 75 ... max = 6883"</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)</span></span>
<span><span class="co">#&gt; Ncells  7219453 385.6   12391758  661.8         NA   8679818  463.6</span></span>
<span><span class="co">#&gt; Vcells 26052258 198.8  231497266 1766.2      16384 239025481 1823.7</span></span></code></pre>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="singlecellexperiment">SingleCellExperiment<a class="anchor" aria-label="anchor" href="#singlecellexperiment"></a>
</h2>
<hr>
<div class="section level3">
<h3 id="build-singlecellexperiment-object">Build SingleCellExperiment object:<a class="anchor" aria-label="anchor" href="#build-singlecellexperiment-object"></a>
</h3>
<p>Run the ‘scprep_build’ function to read the data and create a
SingleCellExperiment object.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read data and create SingleCellExperiment object</span></span>
<span><span class="va">sce_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scprep_build.html">scprep_build</a></span><span class="op">(</span></span>
<span>  sample_paths <span class="op">=</span> <span class="va">sample_paths</span>,</span>
<span>  input_data <span class="op">=</span> <span class="va">example_data</span>, <span class="co"># normally, you would set this to FALSE to read directly from sample_paths</span></span>
<span>  annotation <span class="op">=</span> <span class="va">annotation</span>,</span>
<span>  file_type <span class="op">=</span> <span class="st">"h5"</span>,</span>
<span>  vdj <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  cite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  atac <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"sce"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Building sce object </span></span>
<span><span class="co">#&gt; Using pre-loaded count matrices from input_data </span></span>
<span><span class="co">#&gt; Loaded matrix for Sample_1 : 1000 cells </span></span>
<span><span class="co">#&gt; Loaded matrix for Sample_2 : 1000 cells </span></span>
<span><span class="co">#&gt; Using provided annotation matching input_data names </span></span>
<span><span class="co">#&gt; Total cells loaded: 2000 </span></span>
<span><span class="co">#&gt; Calculate UMIs per cell </span></span>
<span><span class="co">#&gt; Calculate Genes per cell </span></span>
<span><span class="co">#&gt; Creating SingleCellExperiment object directly </span></span>
<span><span class="co">#&gt; SingleCellExperiment object created with 2000 cells and 36601 genes</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="explore-singlecellexperiment-object">Explore SingleCellExperiment Object<a class="anchor" aria-label="anchor" href="#explore-singlecellexperiment-object"></a>
</h3>
<p>Now let’s explore the structure of the Seurat object to understand
where different types of data are stored.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic object information  </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"SingleCellExperiment dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sce_obj</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; SingleCellExperiment dimensions: 36601 2000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of cells:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sce_obj</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of cells: 2000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of genes:"</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sce_obj</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of genes: 36601</span></span>
<span></span>
<span><span class="co"># Expression data (counts matrix)</span></span>
<span><span class="va">counts_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">sce_obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Counts matrix class:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Counts matrix class: matrix array</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Counts matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Counts matrix dimensions: 36601 2000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few genes and cells:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "First few genes and cells:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 AAACCCAGTATATGGA-1-1 AAACCCAGTATCGTAC-1-1 AAACCCAGTCGGTGAA-1-1</span></span>
<span><span class="co">#&gt; ENSG00000243485                    0                    0                    0</span></span>
<span><span class="co">#&gt; ENSG00000237613                    0                    0                    0</span></span>
<span><span class="co">#&gt; ENSG00000186092                    0                    0                    0</span></span>
<span><span class="co">#&gt; ENSG00000238009                    0                    0                    0</span></span>
<span><span class="co">#&gt; ENSG00000239945                    0                    0                    0</span></span>
<span></span>
<span><span class="co"># Cell-level metadata</span></span>
<span><span class="va">cell_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">sce_obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cell metadata dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell metadata dimensions: 2000 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Cell metadata columns:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Cell metadata columns:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "ID"             "Sample"         "Index"          "Sample_Project"</span></span>
<span><span class="co">#&gt;  [5] "Reference"      "Tissue"         "Type"           "Donor"         </span></span>
<span><span class="co">#&gt;  [9] "UMIs"           "Genes"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few rows of cell metadata:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "First few rows of cell metadata:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cell_metadata</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 3 rows and 10 columns</span></span>
<span><span class="co">#&gt;                                        ID   Sample    Index    Sample_Project</span></span>
<span><span class="co">#&gt;                               &lt;character&gt; &lt;factor&gt; &lt;factor&gt;          &lt;factor&gt;</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1 AAACCCAGTATATGGA-1-1 Sample_1 SI-GA-A1 scRNA_10X_Project</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1 AAACCCAGTATCGTAC-1-1 Sample_1 SI-GA-A1 scRNA_10X_Project</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1 AAACCCAGTCGGTGAA-1-1 Sample_1 SI-GA-A1 scRNA_10X_Project</span></span>
<span><span class="co">#&gt;                                            Reference   Tissue     Type    Donor</span></span>
<span><span class="co">#&gt;                                             &lt;factor&gt; &lt;factor&gt; &lt;factor&gt; &lt;factor&gt;</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1 refdata-cellranger-GRCh38-3.0.0    Blood     PBMC        1</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1 refdata-cellranger-GRCh38-3.0.0    Blood     PBMC        1</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1 refdata-cellranger-GRCh38-3.0.0    Blood     PBMC        1</span></span>
<span><span class="co">#&gt;                           UMIs     Genes</span></span>
<span><span class="co">#&gt;                      &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt; AAACCCAGTATATGGA-1-1       860       350</span></span>
<span><span class="co">#&gt; AAACCCAGTATCGTAC-1-1      1548       729</span></span>
<span><span class="co">#&gt; AAACCCAGTCGGTGAA-1-1      6387      1827</span></span>
<span></span>
<span><span class="co"># Gene-level metadata</span></span>
<span><span class="va">gene_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">sce_obj</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gene metadata dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Gene metadata dimensions: 36601 0</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Gene metadata columns:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gene_metadata</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"First few rows of gene metadata:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene_metadata</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Available assays</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Available assays:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Available assays:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assayNames</a></span><span class="op">(</span><span class="va">sce_obj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "counts"</span></span>
<span></span>
<span><span class="co"># Alternative experiments (if any)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/altExps.html" class="external-link">altExpNames</a></span><span class="op">(</span><span class="va">sce_obj</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Alternative experiments:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/altExps.html" class="external-link">altExpNames</a></span><span class="op">(</span><span class="va">sce_obj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Quality control metrics (from scprep)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="st">"UMIs"</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Quality control metrics:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"UMIs per cell: min ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">$</span><span class="va">UMIs</span><span class="op">)</span>, <span class="st">"max ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">$</span><span class="va">UMIs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "Quality control metrics:"</span></span>
<span><span class="co">#&gt; [1] "UMIs per cell: min = 500 max = 61084"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="st">"Genes"</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Genes per cell: min ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">$</span><span class="va">Genes</span><span class="op">)</span>, <span class="st">"max ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">cell_metadata</span><span class="op">$</span><span class="va">Genes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "Genes per cell: min = 75 max = 6883"</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)</span></span>
<span><span class="co">#&gt; Ncells  7239461 386.7   12391758  661.8         NA   9023639  482.0</span></span>
<span><span class="co">#&gt; Vcells 92624784 706.7  231497266 1766.2      16384 239025481 1823.7</span></span></code></pre>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="template-workflow">Template Workflow<a class="anchor" aria-label="anchor" href="#template-workflow"></a>
</h2>
<hr>
<div class="section level3">
<h3 id="for-automated-processing-with-parameter-files-use-the-template_scprep-function">For automated processing with parameter files, use the
<code>template_scprep()</code> function:<a class="anchor" aria-label="anchor" href="#for-automated-processing-with-parameter-files-use-the-template_scprep-function"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create parameter file (scprep_parameters.csv) with output_type specification</span></span>
<span><span class="co"># Parameters file should include:</span></span>
<span><span class="co"># - dir_input: path to input directory</span></span>
<span><span class="co"># - dir_output: path to output directory</span></span>
<span><span class="co"># - output_type: "eset" (ExpressionSet), "seurat", or "sce" (SingleCellExperiment)</span></span>
<span><span class="co"># - file_type: "h5" or "mtx"</span></span>
<span><span class="co"># - Other processing parameters...</span></span>
<span></span>
<span><span class="co"># Run template workflow</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">scprep</span><span class="fu">::</span><span class="fu"><a href="../reference/template_scprep.html">template_scprep</a></span><span class="op">(</span>dir_output <span class="op">=</span> <span class="st">"/path/to/output"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Template workflow benefits:</strong> - Parameter file-driven
approach for reproducible analyses - Automatic parameter logging and
seed generation - Built-in biomaRt gene annotation - Cell filtering -
Gene filtering</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<hr>
<div class="section level3">
<h3 class="unnumbered" id="summary-data-location-by-object-type">Summary: Data Location by Object Type<a class="anchor" aria-label="anchor" href="#summary-data-location-by-object-type"></a>
</h3>
<table class="table">
<colgroup>
<col width="21%">
<col width="24%">
<col width="29%">
<col width="23%">
</colgroup>
<thead><tr>
<th align="left">Data Type</th>
<th align="left">ExpressionSet</th>
<th align="left">Seurat</th>
<th align="left">SingleCellExperiment</th>
</tr></thead>
<tbody>
<tr>
<td align="left"><strong>Counts Matrix</strong></td>
<td align="left"><code>exprs(obj)</code></td>
<td align="left"><code>GetAssayData(obj, slot="counts")</code></td>
<td align="left"><code>counts(obj)</code></td>
</tr>
<tr>
<td align="left"><strong>Cell Metadata</strong></td>
<td align="left"><code>pData(obj)</code></td>
<td align="left"><code>obj@meta.data</code></td>
<td align="left"><code>colData(obj)</code></td>
</tr>
<tr>
<td align="left"><strong>Gene Metadata</strong></td>
<td align="left"><code>fData(obj)</code></td>
<td align="left"><code>obj[["RNA"]]@meta.features</code></td>
<td align="left"><code>rowData(obj)</code></td>
</tr>
<tr>
<td align="left"><strong>Additional Assays</strong></td>
<td align="left"><code>assayData(obj)$SlotName</code></td>
<td align="left"><code>obj[["AssayName"]]</code></td>
<td align="left"><code>assay(obj, "AssayName")</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The <code>scprep</code> package provides a unified interface for
reading 10X Genomics single-cell data and converting it to the most
popular single-cell object formats. Each object type has its own
conventions for storing expression data, metadata, and additional
assays:</p>
<ul>
<li>
<strong>ExpressionSet</strong>: classic Bioconductor format with
<code><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs()</a></code>, <code><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData()</a></code>, and
<code><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData()</a></code>
</li>
<li>
<strong>Seurat</strong>: the most commonly used single-cell R format
with <code><a href="https://rdrr.io/pkg/SeuratObject/man/AssayData.html" class="external-link">GetAssayData()</a></code>, <code>@meta.data</code>, and
assay-specific slots</li>
<li>
<strong>SingleCellExperiment</strong>: the 2nd most commonly used
single-cell R format with <code><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts()</a></code>, <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData()</a></code>,
and <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData()</a></code>
</li>
</ul>
<p>All three formats have the same information - choose the object type
that works for your downstream analysis workflow</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Grant Duclos.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
